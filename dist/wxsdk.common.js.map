{"version":3,"file":"wxsdk.common.js","sources":["../src/utils.js","../src/router.js","../src/handle-config/index.js","../src/report-code.js","../src/core.js","../src/plugin/auto-report.js","../src/plugin/first-screen-time.js","../src/plugin/tap-report.js","../src/overide/wx.js","../src/overide/index.js","../src/index.js"],"sourcesContent":["export const warn = (message, isWarn) => {\r\n  message = `\\n[SDK warn]: ${message}\\n\\n`\r\n  if (isWarn) {\r\n    console.warn(message)\r\n    return\r\n  }\r\n  throw new Error(message)\r\n}\r\n\r\nexport const assert = (condition, error) => {\r\n  if (condition) {\r\n    warn(error)\r\n  }\r\n}\r\n\r\nexport const isUndef = v => {\r\n  return v === null || v === undefined\r\n}\r\n\r\nexport const isFn = f => {\r\n  return typeof f === 'function'\r\n}\r\n\r\nexport const once =  (fn) => {\r\n  let first = true\r\n  return function (...args) {\r\n    if (!first) return\r\n    first = false\r\n    fn.apply(this, args)\r\n  }\r\n}\r\n\r\nexport const callHook = (hooks, name, params) => {\r\n  if (hooks && typeof hooks[name] === 'function') {\r\n    return hooks[name].apply(hooks, params)\r\n  }\r\n  return null\r\n}\r\n\r\nexport const remove = (list, item) => {\r\n  const index = list.indexOf(item)\r\n  if (~index) {\r\n    list.splice(index, 1)\r\n  }\r\n}\r\n\r\nexport const createWraper = (target, fn) => {\r\n  return function (...args) {\r\n    fn.apply(this, args)\r\n    if (typeof target === 'function') {\r\n      return target.apply(this, args)\r\n    }\r\n  }\r\n}\r\n\r\nexport const isPlainObject = obj => {\r\n  if (typeof obj !== 'object' || obj === null) return false\r\n\r\n  const proto = Object.getPrototypeOf(obj)\r\n  if (proto === null) return true\r\n\r\n  let baseProto = proto\r\n  while (Object.getPrototypeOf(baseProto) !== null) {\r\n    baseProto = Object.getPrototypeOf(baseProto)\r\n  }\r\n  return proto === baseProto\r\n}\r\n","// 处理路由跳转相关数据\r\nexport default class Router {\r\n  constructor(sdk) {\r\n    this.sdk = sdk\r\n  }\r\n\r\n  report(name, payload) {\r\n    payload.type = name\r\n    this.sdk.report('router', payload)\r\n  }\r\n\r\n  reportError(name, payload) {\r\n    payload.type = name\r\n    this.sdk.report('routerError', payload)\r\n  }\r\n\r\n  // 获取当前页面\r\n  getCurrentPage() {\r\n    const pages = getCurrentPages()\r\n    return Array.isArray(pages) && pages.length > 0\r\n        ? pages[pages.length - 1]\r\n        : null\r\n  }\r\n}\r\n","// 用来处理 sdkconfig 配置\r\nimport {warn, assert, isFn, isUndef, isPlainObject} from \"../utils\";\r\n\r\nexport default {\r\n  app: {},\r\n\r\n  page: {\r\n    onLoad(sdk, page, opts, SDKConfig) {\r\n      // SDKConfig.onLoad.report1.fn.call(sdk, component)\r\n      const onLoadFns = SDKConfig.onLoad\r\n      for (const key in onLoadFns) {\r\n        if (onLoadFns.hasOwnProperty(key) && typeof onLoadFns[key] === 'function') {\r\n          onLoadFns[key](sdk, page)\r\n        }\r\n      }\r\n    },\r\n\r\n    onShow(sdk, page, opts, SDKConfig) {\r\n      const onShowFns = SDKConfig.onShow\r\n      for (const key in onShowFns) {\r\n        if (onShowFns.hasOwnProperty(key) && typeof onShowFns[key] === 'function') {\r\n          onShowFns[key](sdk, page)\r\n        }\r\n      }\r\n    },\r\n\r\n\r\n    onUnLoad(sdk, page, opts, SDKConfig) {\r\n\r\n    },\r\n\r\n  },\r\n\r\n  component: {},\r\n\r\n  // 不传方法名则执行所有方法\r\n  // 未处理setData之后的update\r\n  update({fnName, params, sdk, SDKConfig, component, isPage, isSetData}) {\r\n    params = isUndef(params) ? {} : params\r\n    // setData之后的自动更新\r\n    if (isSetData) {\r\n      if (!isPlainObject(SDKConfig.updateAfterSetData)) return\r\n      for (const key in SDKConfig.updateAfterSetData) {\r\n        if (SDKConfig.updateAfterSetData.hasOwnProperty(key)) {\r\n          SDKConfig.updateAfterSetData[key]()\r\n        }\r\n      }\r\n      return\r\n    }\r\n\r\n    // 手动调用的更新\r\n    if (!isPlainObject(SDKConfig.update)) return\r\n    // 执行所有update的方法\r\n    if (isUndef(fnName)) {\r\n      for (const key in SDKConfig.update) {\r\n        if (SDKConfig.update.hasOwnProperty(key)) {\r\n          SDKConfig.update[key](params)\r\n        }\r\n      }\r\n      return\r\n    }\r\n    assert(!isFn(SDKConfig.update[fnName]), `Can't find function: ${fnName}`)\r\n    // 执行具体的update fn\r\n    SDKConfig.update[fnName](params)\r\n  }\r\n}\r\n","import {assert} from './utils'\r\n\r\n// 错误类为 1x\r\n// 时间类为 2x\r\n// 路由类为 3x\r\n// 事件类为 4x\r\n// 优先级从上到下\r\nexport const reportCodes = {\r\n  'catchGlobalError': 11, // app 里面捕获到的全局错误\r\n  'routerError': 130, // 路由发送错误的时长\r\n  'router': 30, // 路由跳转成功\r\n}\r\n\r\nexport const addCode = (key, code) => {\r\n  assert(key in reportCodes, `The [${key}] already exists.`)\r\n  reportCodes[key] = code\r\n}\r\n\r\nexport const getCode = key => {\r\n  assert(!(key in reportCodes), `Code [${key}] is does not exist.`)\r\n  return reportCodes[key]\r\n}\r\n","import {\r\n  once,\r\n  warn,\r\n  assert,\r\n  isUndef,\r\n  callHook,\r\n  createWraper,\r\n  isPlainObject,\r\n} from './utils'\r\nimport Router from './router'\r\nimport handleConfigHooks from './handle-config'\r\nimport {getCode, addCode, reportCodes} from './report-code'\r\n\r\nexport default class SDK {\r\n  constructor(opts) {\r\n    this.opts = opts\r\n    this.reportStack = {}\r\n    this.hooks = opts.hooks\r\n    this.depComponents = new Map()\r\n    this.router = new Router(this)\r\n    this.reportCodes = reportCodes\r\n    this.installedPlugins = new Set()\r\n    this.timeStack = Object.create(null)\r\n  }\r\n\r\n  // 创建一个只调用一次的函数\r\n  once(fn) {\r\n    return once(fn)\r\n  }\r\n\r\n  // 用于包装一个方法\r\n  wraper(target, fn) {\r\n    return createWraper(target, fn)\r\n  }\r\n\r\n  addCode(key, code) {\r\n    addCode(key, code)\r\n  }\r\n\r\n  time(type) {\r\n    if (typeof type === 'string') {\r\n      if (isUndef(this.timeStack[type])) {\r\n        this.timeStack[type] = Date.now()\r\n      } else {\r\n        warn(`Timer [${type}] already exists.`, true)\r\n      }\r\n    }\r\n  }\r\n\r\n  timeEnd(type, fn) {\r\n    if (typeof type === 'string') {\r\n      if (!isUndef(this.timeStack[type])) {\r\n        const duration = Date.now() - this.timeStack[type]\r\n        typeof fn === 'function' && fn(duration)\r\n        this.timeStack[type] = null\r\n        return duration\r\n      } else {\r\n        warn(`Timer [${type}] does not exist.`, true)\r\n      }\r\n    }\r\n    return null\r\n  }\r\n\r\n\r\n  // 调用数据上报的钩子\r\n  // 网络请求等具体的副作用暴露给外部\r\n  report(key, payload) {\r\n    key = getCode(key)\r\n\r\n    if (isUndef(this.reportStack[key])) {\r\n      this.reportStack[key] = [payload]\r\n      // 延迟 200ms 做批量上报\r\n      setTimeout(() => {\r\n        callHook(this.hooks, 'report', [key, this.reportStack[key]])\r\n        this.reportStack[key] = null\r\n      }, 200)\r\n    } else if (!isUndef(payload)) {\r\n      this.reportStack[key].push(payload)\r\n    }\r\n  }\r\n\r\n  // 插件\r\n  addPlugin(plugin, ...args) {\r\n    assert(\r\n        this.installedPlugins.has(plugin),\r\n        'Don\\'t repeat install plugin',\r\n    )\r\n\r\n    args.unshift(this)\r\n    if (typeof plugin.install === 'function') {\r\n      plugin.install.apply(plugin, args)\r\n    } else {\r\n      plugin.apply(null, args)\r\n    }\r\n    this.installedPlugins.add(plugin)\r\n  }\r\n\r\n  /**\r\n   * 调用 setData 会调用此函数\r\n   * 开发者手动调用也可以\r\n   * @param component\r\n   * @param data 用户自定义参数\r\n   */\r\n  update(component, fnName, params, isSetData) {\r\n    assert(isUndef(component), 'Missing component')\r\n    const isPage = this.depComponents.get(component)\r\n    const canProcessCfg = isPlainObject(component.SDKConfig)\r\n\r\n    if (canProcessCfg) {\r\n      handleConfigHooks.update({\r\n        fnName,\r\n        params,\r\n        sdk: this,\r\n        SDKConfig: component.SDKConfig,\r\n        component,\r\n        isPage,\r\n        isSetData\r\n      })\r\n    }\r\n\r\n    callHook(this.hooks, 'update', [this, component, isPage])\r\n  }\r\n}\r\n","import {assert, isUndef, createWraper} from '../utils'\r\n\r\n// 自动上报的插件\r\nexport default function (sdk, opts = {}) {\r\n  assert(\r\n      typeof opts.url !== 'string',\r\n      'The request url must be a string.\\n\\n --- from [autoReport] plugin\\n',\r\n  )\r\n\r\n  assert(\r\n      !('projectName' in opts),\r\n      'Must defined [projectName] field.'\r\n  )\r\n\r\n  // 允许上报的方法\r\n  const allowMethods = ['GET', 'POST']\r\n  // 这些是固定需要上报的数据\r\n  const genData = bm => {\r\n    const uid = typeof opts.uid === 'function' ? opts.uid() : ''\r\n    return {\r\n      bm,\r\n      uid,\r\n      tp: 0,\r\n      sp: 'stat',\r\n      sc: opts.projectName,\r\n      t: Date.parse(new Date()),\r\n      unid: 'za-ad10c-16d630b0690',\r\n      p: sdk.router.getCurrentPage().route,\r\n    }\r\n  }\r\n\r\n  // 只处理默认的类型，其他用于自己定义的通过回调来得到数据\r\n  function wraperReprot(key, val) {\r\n    let data = []\r\n    let method = 'GET'\r\n\r\n    switch (key) {\r\n        // catchGlobalError\r\n      case 11 :\r\n        break\r\n\r\n        // routerError\r\n      case 130 :\r\n        break\r\n\r\n        // showTime\r\n      case 21 :\r\n        break\r\n\r\n        // initToRequestTime\r\n      case 20 :\r\n        data = val.map(initToRequestTime => ({...genData('time'), exd: {initToRequestTime}}))\r\n        break\r\n\r\n        // renderContentTime\r\n      case 22 :\r\n        data = val.map(renderContentTime => ({...genData('time'), exd: {renderContentTime}}))\r\n        break\r\n\r\n        // renderAllContentTime\r\n      case 23 :\r\n        data = val.map(renderAllContentTime => ({...genData('time'), exd: {renderAllContentTime}}))\r\n        break\r\n\r\n        // router\r\n      case 30 :\r\n        break\r\n\r\n        // other\r\n      default :\r\n        if (typeof opts.callback === 'function') {\r\n          const {data: _d, method: _m, module: _bm} = opts.callback(key, val)\r\n          assert(\r\n              !Array.isArray(data),\r\n              '[data] must be an Array\\n\\n --- from [autoReport] plugin\\n',\r\n          )\r\n\r\n          assert(\r\n              typeof _bm !== 'string',\r\n              '[module] must be an String\\n\\n --- from [autoReport] plugin\\n',\r\n          )\r\n\r\n          // 保持需要处理的数据\r\n          method = _m\r\n          data = _d.map(exd => ({...genData(_bm), exd}))\r\n        }\r\n    }\r\n\r\n    if (allowMethods.includes(method) && data.length > 0) {\r\n      // 由于后端不支持一次性上报多条数据\r\n      // 所以需要发送多条请求，等接口更改\r\n      data.forEach(item => {\r\n        wx.request({\r\n          method,\r\n          data: item,\r\n          url: opts.url,\r\n          header: opts.header || {},\r\n        })\r\n      })\r\n    }\r\n  }\r\n\r\n  if (\r\n      isUndef(sdk.hooks.report) ||\r\n      typeof sdk.hooks.report === 'function' &&\r\n      sdk.hooks.report.name !== 'defaultReport'\r\n  ) {\r\n    sdk.hooks.report = createWraper(sdk.hooks.report, wraperReprot)\r\n  } else {\r\n    sdk.hooks.report = wraperReprot\r\n  }\r\n}\r\n","import {\r\n  once,\r\n  isUndef,\r\n  createWraper,\r\n} from '../utils'\r\n\r\n// 首屏的各种加载时长统计\r\nexport default function (sdk) {\r\n  let entryPath = null\r\n  const hooks = sdk.hooks\r\n  if (isUndef(hooks.app)) hooks.app = {}\r\n  if (isUndef(hooks.page)) hooks.page = {}\r\n\r\n  sdk.addCode('initToRequestTime', 20) // 初始化到发起请求的时间\r\n  sdk.addCode('showTime', 21) // 小程序启动的时长\r\n  sdk.addCode('renderContentTime', 22)  // 首屏有内容显示\r\n  sdk.addCode('renderAllContentTime', 23) // 所有内容显示的时间\r\n\r\n  // app 里面需要记录的时间\r\n  hooks.app.onLaunch = createWraper(\r\n      hooks.app.onLaunch,\r\n      (sdk, app, opts) => {\r\n        // 记录当前启动是哪个页面\r\n        entryPath = opts.path\r\n        // 记录初始化的时间\r\n        sdk.time('initToRequestTime')\r\n      },\r\n  )\r\n\r\n  hooks.app.onShow = createWraper(\r\n      hooks.app.onShow,\r\n      () => {\r\n        if (!isUndef(entryPath)) {\r\n          sdk.time('renderContentTime')\r\n        }\r\n        // 打点记录渲染所有时长的时间，具体的接口在业务中写\r\n        sdk.time('renderAllContentTime')\r\n        // 记录当前 app 从显示到隐藏，一共停留的时长\r\n        sdk.time('showTime')\r\n      },\r\n  )\r\n\r\n  hooks.app.onHide = createWraper(\r\n      hooks.app.onHide,\r\n      () => {\r\n        const duration = sdk.timeEnd('showTime')\r\n        sdk.report('showTime', duration)\r\n      },\r\n  )\r\n\r\n  hooks.app.onError = createWraper(\r\n      hooks.app.onError,\r\n      errMsg => {\r\n        // 自动上报在 app 里面捕获到的错误\r\n        sdk.report('catchGlobalError', errMsg)\r\n      },\r\n  )\r\n\r\n  // 首页渲染完成的时间\r\n  hooks.page.onReady = createWraper(\r\n      hooks.app.onReady,\r\n      once((sdk, page) => {\r\n        if (entryPath === page.route) {\r\n          const duration = sdk.timeEnd('renderContentTime')\r\n          sdk.report('renderContentTime', duration)\r\n        }\r\n      }),\r\n  )\r\n\r\n  // 在 SDK 中添加当前这个插件的方法\r\n  sdk.firstScreen = {\r\n    initToRequest: once(() => {\r\n      const duration = sdk.timeEnd('initToRequestTime')\r\n      sdk.report('initToRequestTime', duration)\r\n    }),\r\n\r\n    renderAllTime: once(() => {\r\n      const duration = sdk.timeEnd('renderAllContentTime')\r\n      sdk.report('renderAllContentTime', duration)\r\n    }),\r\n  }\r\n}\r\n","import {assert, createWraper} from \"../utils\";\r\n// 统计用户页面点击\r\nimport {isUndef} from \"../utils\";\r\n\r\nexport default function (sdk, opts = {}) {\r\n  assert(\r\n    typeof opts.url !== 'string',\r\n    'The request url must be a string.\\n\\n --- from [autoReport] plugin\\n',\r\n  )\r\n\r\n  const hooks = sdk.hooks\r\n  if (isUndef(hooks.app)) hooks.app = {}\r\n  if (isUndef(hooks.page)) hooks.page = {}\r\n\r\n  sdk.addCode('tapEvent', 40)\r\n\r\n  hooks.page.overrideBefore = createWraper(\r\n    hooks.page.overrideBefore,\r\n    function (sdk, config) {\r\n      config.tapReport = function (e) {\r\n        let reportDataKey = e.target.dataset.zareport\r\n        assert(typeof reportDataKey !== 'string', 'The zareport must be a string.\\n\\n --- from [tap-report] plugin\\n')\r\n        assert(!config.SDKConfig.reportData || !config.SDKConfig.reportData.hasOwnProperty(reportDataKey), `Unrecognized report params key ${reportDataKey}. --- from [tap-report] plugin`)\r\n\r\n        const params = config.SDKConfig.reportData[reportDataKey] || {}\r\n\r\n        wx.request({\r\n          url: opts.url,\r\n          data: params,\r\n          success: res => {\r\n          }\r\n        })\r\n      }\r\n    }\r\n  )\r\n}\r\n","import { createWraper } from '../utils'\r\n\r\nconst handleRouter = (routerType, router, opts = {}) => {\r\n  const { fail, success } = opts\r\n  const info = {\r\n    to: opts.url,\r\n    from: router.getCurrentPage().route,\r\n  }\r\n\r\n  // 路由跳转成功\r\n  opts.success = createWraper(\r\n    success,\r\n    () => router.report(routerType, info),\r\n  )\r\n\r\n  // 路由跳转发生错误\r\n  opts.fail = createWraper(\r\n    fail,\r\n    error => {\r\n      info.error = error\r\n      router.reportError(routerType, info)\r\n    },\r\n  )\r\n}\r\n\r\nexport default (sdk, rewrite) => {\r\n  // 导航相关方法\r\n  rewrite('reLaunch', opts => handleRouter('reLaunch', sdk.router, opts))\r\n  rewrite('switchTab', opts => handleRouter('switchTab', sdk.router, opts))\r\n  rewrite('navigateTo', opts => handleRouter('navigateTo', sdk.router, opts))\r\n  rewrite('redirectTo', opts => handleRouter('redirectTo', sdk.router, opts))\r\n}","import overideWX from './wx'\r\nimport handleConfigHooks from '../handle-config'\r\nimport {createWraper, isPlainObject, assert, callHook} from '../utils'\r\n\r\nexport const SDKCfgNamespace = 'SDKConfig'\r\n\r\n// 需要包裹的生命周期\r\nconst pageLifeTime = 'onLoad,onShow,onReady,onHide,onUnload'\r\nconst componentLifeTime = 'created,attached,ready,moved,detached'\r\nconst appLifeTime = 'onLaunch,onShow,onHide,onError,onPageNotFound'\r\n\r\n// 重写 component 和 page 的 config\r\nexport function overideComponent(sdk, config, isPage) {\r\n  const SDKConfig = config[SDKCfgNamespace]\r\n  const canProcessCfg = isPlainObject(SDKConfig)\r\n\r\n  const dispatch = (name, component, opts) => {\r\n    let compHooks, configHooks\r\n\r\n    // 得到钩子对象\r\n    if (isPage) {\r\n      compHooks = sdk.hooks.page\r\n      configHooks = handleConfigHooks.page\r\n    } else {\r\n      compHooks = sdk.hooks.component\r\n      configHooks = handleConfigHooks.component\r\n    }\r\n\r\n    if (name === 'onLoad' || name === 'attached') {\r\n      // 将 SDK 注入到组件中\r\n      component.SDK = sdk\r\n      // 添加依赖\r\n      sdk.depComponents.set(component, isPage)\r\n\r\n      // 包装 setState 方法，组件的每次更新我们都需要知道\r\n      const setData = component.setData\r\n      component.setData = function (data, callback) {\r\n        setData.call(this, data,\r\n            createWraper(callback, () => {\r\n              sdk.update(this, null, null, true)\r\n            })\r\n        )\r\n      }\r\n    }\r\n    if (name === 'onUnload' || name === 'detached') {\r\n      sdk.depComponents.delete(component)\r\n    }\r\n\r\n    // 如果当前组件有关于 sdk 的配置就需要处理\r\n    if (canProcessCfg) {\r\n      component[SDKCfgNamespace] = SDKConfig\r\n      callHook(configHooks, 'onLoad', [sdk, component, opts, SDKConfig, isPage])\r\n    }\r\n    callHook(compHooks, name, [sdk, component, opts])\r\n  }\r\n\r\n  callHook(sdk.hooks.page, 'overrideBefore', [sdk, config])\r\n  callHook(sdk.hooks.component, 'overrideBefore', [sdk, config])\r\n\r\n  // 包装所有生命周期函数\r\n  // 然后调用 hooks，具体的实现内容可以通过插件的形式处理\r\n  if (isPage) {\r\n    pageLifeTime.split(',').forEach(name => {\r\n      config[name] = createWraper(\r\n          config[name],\r\n          function (opts) {\r\n            dispatch(name, this, opts)\r\n          },\r\n      )\r\n    })\r\n  } else {\r\n    // Component\r\n    config.lifetimes = config.lifetimes || {}\r\n    const get = key => config[key] || config.lifetimes[key]\r\n    const set = (key, fn) => config[key] = config.lifetimes[key] = fn\r\n\r\n    componentLifeTime.split(',').forEach(name => {\r\n      set(name,\r\n          createWraper(\r\n              get(name),\r\n              function (opts) {\r\n                dispatch(name, this, opts)\r\n              },\r\n          )\r\n      )\r\n    })\r\n  }\r\n  return config\r\n}\r\n\r\n// 重写 app 的 config\r\nexport function overideApp(sdk, config) {\r\n  const SDKConfig = config[SDKCfgNamespace]\r\n  const canProcessCfg = isPlainObject(SDKConfig)\r\n\r\n  appLifeTime.split(',').forEach(name => {\r\n    config[name] = createWraper(\r\n        config[name],\r\n        function (opts) {\r\n          if (canProcessCfg) {\r\n            this[SDKCfgNamespace] = SDKConfig\r\n            callHook(handleConfigHooks.app, name, [sdk, this, opts, SDKConfig, isPage])\r\n          }\r\n          callHook(sdk.hooks.app, name, [sdk, this, opts])\r\n        },\r\n    )\r\n  })\r\n\r\n  return config\r\n}\r\n\r\n// 重写 wx 类\r\nexport function overideWxClass(sdk, nativeWX) {\r\n  const overideClass = {}\r\n\r\n  overideWX(sdk, (name, fn) => {\r\n    // 只允许重写，不允许新增\r\n    // 如果需要新增全局方法，不应该写在这里\r\n    assert(!(name in nativeWX), 'Only allowed to rewrite.')\r\n    assert(name in overideClass, `${name} has been rewritten`)\r\n    overideClass[name] = createWraper(nativeWX[name], fn)\r\n  })\r\n\r\n  wx = Object.assign({}, nativeWX, overideClass)\r\n}\r\n","import SDK from './core'\r\nimport {warn} from './utils'\r\nimport * as plugins from './plugin'\r\nimport {overideApp, overideComponent, overideWxClass} from './overide'\r\n\r\nlet isInitComplete = false\r\n\r\nconst nativeWX = wx\r\nconst nativeApp = App\r\nconst nativePage = Page\r\nconst nativeComponent = Component\r\n\r\nconst filterOpts = opts => {\r\n  return Object.assign(\r\n      {\r\n        hooks: {\r\n          // defaultReport 这个函数名是需要的，在一些插件里面可能需要因此判断是不是默认的函数\r\n          report: function defaultReport() {\r\n            warn('you need defined [report] hook function.')\r\n          },\r\n        },\r\n      },\r\n      opts,\r\n  )\r\n}\r\n\r\nfunction initSDK(opts) {\r\n  if (isInitComplete) {\r\n    warn('Can\\'t allow repeat initialize.')\r\n  }\r\n\r\n  const sdk = new SDK(filterOpts(opts || {}))\r\n\r\n  Page = function (config) {\r\n    config = overideComponent(sdk, config, true)\r\n    return nativePage.call(this, config)\r\n  }\r\n  Component = function (config) {\r\n    config = overideComponent(sdk, config, false)\r\n    return nativeComponent.call(this, config)\r\n  }\r\n  App = function (config) {\r\n    config = overideApp(sdk, config)\r\n    return nativeApp.call(this, config)\r\n  }\r\n  // 重写 wx 原生类\r\n  overideWxClass(sdk, nativeWX)\r\n\r\n  isInitComplete = true\r\n  return sdk\r\n}\r\n\r\nexport {\r\n  plugins,\r\n  initSDK as default,\r\n}\r\n"],"names":["warn","message","isWarn","console","Error","assert","condition","error","isUndef","v","undefined","isFn","f","once","fn","first","args","apply","callHook","hooks","name","params","createWraper","target","isPlainObject","obj","proto","Object","getPrototypeOf","baseProto","Router","constructor","sdk","report","payload","type","reportError","getCurrentPage","pages","getCurrentPages","Array","isArray","length","app","page","onLoad","opts","SDKConfig","onLoadFns","key","hasOwnProperty","onShow","onShowFns","onUnLoad","component","update","fnName","isPage","isSetData","updateAfterSetData","reportCodes","addCode","code","getCode","SDK","reportStack","depComponents","Map","router","installedPlugins","Set","timeStack","create","wraper","time","Date","now","timeEnd","duration","setTimeout","push","addPlugin","plugin","has","unshift","install","add","get","canProcessCfg","handleConfigHooks","url","allowMethods","genData","bm","uid","tp","sp","sc","projectName","t","parse","unid","p","route","wraperReprot","val","data","method","map","initToRequestTime","exd","renderContentTime","renderAllContentTime","callback","_d","_m","module","_bm","includes","forEach","item","wx","request","header","entryPath","onLaunch","path","onHide","onError","errMsg","onReady","firstScreen","initToRequest","renderAllTime","overrideBefore","config","tapReport","e","reportDataKey","dataset","zareport","reportData","success","res","handleRouter","routerType","fail","info","to","from","rewrite","SDKCfgNamespace","pageLifeTime","componentLifeTime","appLifeTime","overideComponent","dispatch","compHooks","configHooks","set","setData","call","delete","split","lifetimes","overideApp","overideWxClass","nativeWX","overideClass","overideWX","assign","isInitComplete","nativeApp","App","nativePage","Page","nativeComponent","Component","filterOpts","defaultReport","initSDK"],"mappings":"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"}