{"version":3,"file":"wxsdk.esm.js","sources":["../src/router.js","../src/utils.js","../src/report-code.js","../src/core.js","../src/overide/wx.js","../src/handle-config/index.js","../src/overide/index.js","../src/index.js"],"sourcesContent":["// 处理路由跳转相关数据\r\nexport default class Router {\r\n  constructor (sdk) {\r\n    this.sdk = sdk\r\n  }\r\n\r\n  report (name, payload) {\r\n    payload.type = name\r\n    this.sdk.report('router', payload)\r\n  }\r\n\r\n  reportError (name, payload) {\r\n    payload.type = name\r\n    this.sdk.report('routerError', payload)\r\n  }\r\n}","export const warn = (message, isWarn) => {\r\n  message = `\\n[SDK warn]: ${message}\\n\\n`\r\n  if (isWarn) {\r\n    console.warn(message)\r\n    return\r\n  }\r\n  throw new Error(message)\r\n}\r\n\r\nexport const assert = (condition, error) => {\r\n  if (condition) {\r\n    warn(error)\r\n  }\r\n}\r\n\r\nexport const isUndef = v => {\r\n  return v === null || v === undefined\r\n}\r\n\r\nexport const callHook = (hooks, name, params) => {\r\n  if (hooks && typeof hooks[name] === 'function') {\r\n    return hooks[name].apply(hooks, params)\r\n  }\r\n  return null\r\n}\r\n\r\nexport const remove = (list, item) => {\r\n  const index = list.indexOf(item)\r\n  if (~index) {\r\n    list.splice(index, 1)\r\n  }\r\n}\r\n\r\nexport const createWraper = (target, fn) => {\r\n  return function (...args) {\r\n    fn.apply(this, args)\r\n    if (typeof target === 'function') {\r\n      return target.apply(this, args)\r\n    }\r\n  }\r\n}\r\n\r\nexport const isPlainObject = obj => {\r\n  if (typeof obj !== 'object' || obj === null) return false\r\n\r\n  const proto = Object.getPrototypeOf(obj)\r\n  if (proto === null) return true\r\n\r\n  let baseProto = proto\r\n  while (Object.getPrototypeOf(baseProto) !== null) {\r\n    baseProto = Object.getPrototypeOf(baseProto)\r\n  }\r\n  return proto === baseProto\r\n}","import { assert } from './utils'\r\n\r\n// 错误类为 1x\r\n// 时间类为 2x\r\n// 路由类为 3x\r\n// 优先级从上到下\r\nexport const reportCodes = {\r\n  'router': 30, // 路由跳转成功\r\n  'showTime': 21, // 小程序从 show 到 hide 的时长\r\n  'startTime': 20, // 小程序启动的时长\r\n  'routerError': 130, // 路由发送错误的时长\r\n  'catchGlobalError': 11, // app 里面捕获到的全局错误\r\n}\r\n\r\nexport default function (key) {\r\n  assert(!(key in reportCodes), `The ${key} is does not exist.`)\r\n  return reportCodes[key]\r\n}","import Router from './router'\r\nimport code, { reportCodes } from './report-code'\r\nimport { warn, assert, isUndef, callHook, createWraper } from './utils'\r\n\r\nexport default class SDK {\r\n  constructor (opts) {\r\n    this.opts = opts\r\n    this.reportStack = {}\r\n    this.hooks = opts.hooks\r\n    this.depComponents = new Map()\r\n    this.router = new Router(this)\r\n    this.installedPlugins = new Set()\r\n    this.timeStack = Object.create(null)\r\n  }\r\n\r\n  time (type) {\r\n    if (typeof type === 'string') {\r\n      if (isUndef(this.timeStack[type])) {\r\n        this.timeStack[type] = Date.now()\r\n      } else {\r\n        warn(`Timer [${type}] already exists.`, true)\r\n      }\r\n    }\r\n  }\r\n\r\n  timeEnd (type, fn) {\r\n    if (typeof type === 'string') {\r\n      if (!isUndef(this.timeStack[type])) {\r\n        const duration = Date.now() - this.timeStack[type]\r\n        typeof fn === 'function' && fn(duration)\r\n        this.timeStack[type] = null\r\n        return duration\r\n      }\r\n    } else {\r\n      warn(`Timer [${type}] does not exist.`, true)\r\n    }\r\n    return null\r\n  }\r\n\r\n  // 调用数据上报的钩子\r\n  // 网络请求等具体的副作用暴露给外部\r\n  report (key, payload) {\r\n    key = code(key)\r\n\r\n    if (isUndef(this.reportStack[key])) {\r\n      this.reportStack[key] = [payload]\r\n      // 延迟 200ms 做批量上报\r\n      setTimeout(() => {\r\n        callHook(this.hooks, 'report', [key, this.reportStack[key]])\r\n        this.reportStack[key] = null\r\n      }, 200)\r\n    } else {\r\n      this.reportStack[key].push(payload)\r\n    }\r\n  }\r\n\r\n  // 用于重写一个方法\r\n  wraper (obj, name, fn) {\r\n    assert(!(name in obj), 'The method that needs to be wrapped is not a function')\r\n    obj[name] = createWraper(obj[name], fn)\r\n  }\r\n\r\n  // 插件\r\n  use (plugin, ...args) {\r\n    if (this.installedPlugins.has(plugin)) {\r\n      return\r\n    }\r\n\r\n    args.unshift(this)\r\n    if (typeof plugin.install === 'function') {\r\n      plugin.install.apply(plugin, args)\r\n    } else {\r\n      plugin.apply(null, args)\r\n    }\r\n    this.installedPlugins.add(plugin)\r\n  }\r\n}\r\n\r\n// 上报状态码表\r\nSDK._reportCodes = reportCodes","import { createWraper } from '../utils'\r\n\r\n// 获取当前页面\r\nconst getCurrentPagePath = () => {\r\n  const pages = getCurrentPages()\r\n  return Array.isArray(pages) && pages.length > 0\r\n    ? pages[pages.length - 1].route\r\n    : null\r\n}\r\n\r\nconst handleRouter = (routerType, router, opts = {}) => {\r\n  const { fail, success } = opts\r\n  const info = {\r\n    to: opts.url,\r\n    from: getCurrentPagePath(),\r\n  }\r\n\r\n  // 路由跳转成功\r\n  opts.success = createWraper(\r\n    success,\r\n    () => router.report(routerType, info),\r\n  )\r\n\r\n  // 路由跳转发生错误\r\n  opts.fail = createWraper(\r\n    fail,\r\n    error => {\r\n      info.error = error\r\n      router.reportError(routerType, info)\r\n    },\r\n  )\r\n}\r\n\r\nexport default (sdk, rewrite) => {\r\n  // 导航相关方法\r\n  rewrite('reLaunch', opts => handleRouter('reLaunch', sdk.router, opts))\r\n  rewrite('switchTab', opts => handleRouter('switchTab', sdk.router, opts))\r\n  rewrite('navigateTo', opts => handleRouter('navigateTo', sdk.router, opts))\r\n  rewrite('redirectTo', opts => handleRouter('redirectTo', sdk.router, opts))\r\n}","export function load (sdk, component, SDKConfig, isPage) {\r\n\r\n}\r\n\r\nexport function unLoad (sdk, component, SDKConfig, isPage) {\r\n\r\n}\r\n\r\nexport default {\r\n  onLoad () {\r\n\r\n  },\r\n\r\n  onUnLoad () {\r\n\r\n  },\r\n}","import overideWX from './wx'\r\nimport handleConfigHooks from '../handle-config'\r\nimport { createWraper, isPlainObject, assert, callHook } from '../utils'\r\n\r\nexport const SDKCfgNamespace = 'SDKConfig'\r\n\r\nconst pageLifeTime = 'onLoad,onShow,onReady,onHide,onUnload'\r\nconst componentLifeTime = 'created,attached,ready,moved,detached'\r\n\r\n/**\r\n * 数据统计的具体实现思路\r\n *  1. 需要对各种时长进行统计\r\n *  2. 对页面点击的埋点统计\r\n *  3. 自定业务逻辑的埋点统计\r\n *  4. 向外暴露的 api\r\n */\r\n\r\n// 重写 component 和 page 的 config\r\nexport function overideComponent (sdk, config, isPage) {\r\n  const SDKConfig = config[SDKCfgNamespace]\r\n  const canProcessCfg = isPlainObject(SDKConfig)\r\n\r\n  const dispatch = (name, component, opts) => {\r\n    if (name === 'onLoad' || name === 'attached') {\r\n      // 添加依赖\r\n      sdk.depComponents.set(component, isPage)\r\n    }\r\n\r\n    if (name === 'onUnload' || name === 'detached') {\r\n      sdk.depComponents.delete(component)\r\n    }\r\n\r\n    // 如果当前组件有关于 sdk 的配置就需要处理\r\n    if (canProcessCfg) {\r\n      component[SDKCfgNamespace] = SDKConfig\r\n      callHook(handleConfigHooks, 'onLoad', [sdk, this, opts, SDKConfig, isPage])\r\n    }\r\n\r\n    const compHooks = isPage\r\n      ? sdk.hooks.page\r\n      : sdk.hooks.component\r\n  \r\n    callHook(compHooks, name, [sdk, this, opts])\r\n  }\r\n\r\n  // 包装所有生命周期函数\r\n  // 然后调用 hooks，具体的实现内容可以通过插件的形式处理\r\n  if (isPage) {\r\n    pageLifeTime.split(',').forEach(name => {\r\n      config[name] = createWraper(\r\n        name,\r\n        function (opts) {\r\n          dispatch(name, this, opts)\r\n        },\r\n      )\r\n    })\r\n  } else {\r\n    // Component\r\n    config.lifetimes = config.lifetimes || {}\r\n    const get = key => config[key] || config.lifetimes[key]\r\n    const set = (key, fn) => config[key] = config.lifetimes[key] = fn \r\n\r\n    componentLifeTime.split(',').forEach(name => {\r\n      set(name,\r\n        createWraper(\r\n          get(name),\r\n          function (opts) {\r\n            dispatch(name, this, opts)\r\n          },\r\n        )  \r\n      )\r\n    })\r\n  }\r\n  return config\r\n}\r\n\r\n// 重写 app 的 config\r\nexport function overideApp (sdk, config) {\r\n  const nativeShow = config.onShow\r\n  const nativeHide = config.onHide\r\n  const nativeError = config.onError\r\n\r\n  config.onShow = createWraper(\r\n    nativeShow,\r\n    function () {\r\n      // 记录当前 app 从显示到隐藏，一共停留的时长\r\n      sdk.time('showTime')\r\n      // 记录初始化的时长\r\n      const duration = sdk.timeEnd('startTime')\r\n      sdk.report('startTime', duration)\r\n    },\r\n  )\r\n\r\n  config.onHide = createWraper(\r\n    nativeHide,\r\n    function () {\r\n      const duration = sdk.timeEnd('showTime')\r\n      sdk.report('showTime', duration)\r\n    },\r\n  )\r\n\r\n  config.onError = createWraper(\r\n    nativeError,\r\n    function (errMsg) {\r\n      // 自动上报在 app 里面捕获到的错误\r\n      sdk.report('globalCatchError', errMsg)\r\n    },\r\n  )\r\n\r\n  return config\r\n}\r\n\r\n// 重写 wx 类\r\nexport function overideWxClass (sdk, nativeWX) {\r\n  const overideClass = {}\r\n\r\n  overideWX(sdk, (name, fn) => {\r\n    // 只允许重写，不允许新增\r\n    // 如果需要新增全局方法，不应该写在这里\r\n    assert(!(name in nativeWX), 'Only allowed to rewrite.')\r\n    assert(name in overideClass, `${name} has been rewritten`)\r\n    overideClass[name] = createWraper(nativeWX[name], fn)\r\n  })\r\n\r\n  wx = Object.assign({}, nativeWX, overideClass)\r\n}","import SDK from './core'\r\nimport { warn } from './utils'\r\nimport { overideApp, overideComponent, overideWxClass } from './overide'\r\n\r\nlet isInitComplete = false\r\n\r\nconst nativeWX = wx\r\nconst nativeApp = App\r\nconst nativePage = Page\r\nconst nativeComponent = Component\r\n\r\nconst filterOpts = opts => {\r\n  return Object.assign(\r\n    {\r\n      hooks: {\r\n        report () {\r\n          warn('you need defined [report] hook function.')\r\n        },\r\n      },\r\n    },\r\n    opts,\r\n  )\r\n}\r\n\r\nexport default function (opts) {\r\n  if (isInitComplete) {\r\n    warn('Can\\'t allow repeat initialize.')\r\n  }\r\n\r\n  const sdk = new SDK(filterOpts(opts || {}))\r\n\r\n  // 记录项目启动时的时机点\r\n  sdk.time('startTime')\r\n\r\n  Page = function (config) {\r\n    config = overideComponent(sdk, config, true)\r\n    return nativePage.call(this, config)\r\n  }\r\n  Component = function (config) {\r\n    config = overideComponent(sdk, config, false)\r\n    return nativeComponent.call(this, config)\r\n  }\r\n  App = function (config) {\r\n    config = overideApp(sdk, config)\r\n    return nativeApp.call(this, config)\r\n  }\r\n  // 重写 wx 原生类\r\n  overideWxClass(sdk, nativeWX)\r\n\r\n  isInitComplete = true\r\n  return sdk\r\n}"],"names":["Router","constructor","sdk","report","name","payload","type","reportError","warn","message","isWarn","console","Error","assert","condition","error","isUndef","v","undefined","callHook","hooks","params","apply","createWraper","target","fn","args","isPlainObject","obj","proto","Object","getPrototypeOf","baseProto","reportCodes","key","SDK","opts","reportStack","depComponents","Map","router","installedPlugins","Set","timeStack","create","time","Date","now","timeEnd","duration","code","setTimeout","push","wraper","use","plugin","has","unshift","install","add","_reportCodes","getCurrentPagePath","pages","getCurrentPages","Array","isArray","length","route","handleRouter","routerType","fail","success","info","to","url","from","rewrite","onLoad","onUnLoad","SDKCfgNamespace","pageLifeTime","componentLifeTime","overideComponent","config","isPage","SDKConfig","canProcessCfg","dispatch","component","set","delete","handleConfigHooks","compHooks","page","split","forEach","lifetimes","get","overideApp","nativeShow","onShow","nativeHide","onHide","nativeError","onError","errMsg","overideWxClass","nativeWX","overideClass","overideWX","wx","assign","isInitComplete","nativeApp","App","nativePage","Page","nativeComponent","Component","filterOpts","call"],"mappings":"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"}